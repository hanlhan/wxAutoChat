<body class="typora-export">
# 实践方法论

1. 一个优秀的机器学习实践者需要知道：

    * 存在哪些算法以及这些算法为何有效的原理
    * 如何针对具体应用挑选一个合适的算法
    * 如何监控算法，并根据实验反馈改进机器学习系统

2. 实际开发过程中，实践者需要决定：是否收集更多的数据、是否需要增加/降低模型容量、是否需要添加/删除正则化项、是否需要改进模型的优化算法、是否需要改进模型的近似推断....这些都需要大量的时间

3. 在实际应用中，正确使用一个普通算法通常要比草率的使用一个不清楚的算法要效果更好

4. 正确应用一个算法需要掌握一些相当简单的方法论：

    * 确定目标：使用什么样的误差度量（是准确率还是召回率？），并为此误差度量确定目标（我们期望达到什么样的效果：如召回率大于95%？）

        * 这些目标和误差度量取决于该应用为了解决什么问题

    * 尽快建立一个端到端的工作流程，包括计算出合适的性能度量（如：计算出召回率）

    * 搭建系统，并确定性能瓶颈。

        * 检查哪个部分的性能差于预期
        * 检查差于预期的原因：是否过拟合、欠拟合、还是数据或者软件缺陷造成的

    * 根据具体观察反复进行增量式改动：如收集新数据、调整超参数、改进算法



## 一、性能度量

1. 确定目标，即使用什么误差度量是第一步

    * 因为误差度量将指导接下来的所有工作
    * 同时我们也能够了解大概能得到什么级别的目标性能

2. 对大多数应用而言，不可能实现绝对零误差

    * 即使有无限的训练数据，并且恢复了真正的概率分布，但是由于输入特征可能无法包含输出变量的完整信息、或者系统本质上是个随机系统，则仍然产生了误差
    * 当然实际上我们也不可能有无限的训练数据

3. 通常我们需要收集更多的数据。但是我们需要在收集更多数据的成本，与进一步减少误差的价值之间权衡

4. 通常我们需要对错误率定一个 baseline 从而判断预测得好坏

    * 对于学术界，我们可以将先前公布的基准结果作为 baseline
    * 在工业界，我们从安全的、能带来性价比、或者能吸引用户的角度来确定错误率的 baseline

5. 性能度量：表明从哪个角度来度量算法的性能

    * 常见的有：精度`precision`，召回率`recall`以及 `PR curve`，`ROC`曲线，`F-score`等

    * 还有一种：覆盖率。它是机器学习系统能够产生响应的样本占所有样本的比例

        * 一个系统可以拒绝处理任何样本，从而达到 100% 的精度。但是覆盖率为 0%

    * 也可以从专业角度考量：点击率、用户满意度调查等等

    * 最重要的是：确定使用哪个性能度量



## 二、默认的基准模型

1. 根据问题的复杂性，项目开始时可能无需使用深度学习

    * 如果只需要正确选择几个线性权重就能解决问题，那么项目开始可以使用一个简单的统计模型，如逻辑回归

2. 如果问题属于 “AI-完全”类型的，如对象识别、语音识别等，那么项目开始于一个合适的深度学习模型，则效果会比较好

3. 根据数据结构选择一类合适的模型：

    * 如果是以固定大小的向量作为输入的有监督学习，那么可以使用全连接的前馈网络
    * 如果输入已知的拓扑结构（如图像），则可以使用卷积网络
    * 如果输入或者输出是一个序列，则使用门控循环网络（LSTM 或者 GRU）

4. 刚开始时可以使用某些分段线性单元：如 `ReLU`或者其扩展

5. 可以选择具有衰减学习率以及动量的`SGD`作为优化算法

    * 常见的衰减方法有：

        * 衰减到固定最低学习率的线性衰减
        * 指数衰减
        * 每次发生验证错误停滞时将学习率降低 2-10 倍的衰减策略

    * 另一种优化选择是 `Adam`算法


6. `batch normalization`对优化性能有着显著的影响，特别是对于卷积网络和具有`sigmoid`非线性函数的网络而言

    * 最初的基准中，可以忽略`batch normalization`
    * 当优化似乎出现问题时，应立即使用`batch normalization`

7. 除非训练集包含数千万或者更多的样本，否则项目一开始就应该包含一些温和的正则化

    * 建议采用早停策略
    * 建议采用`dropout`策略，它也兼容很多模型以及许多正则化项
    * `batch normalization` 有时可以降低泛化误差，此时可以省略`dropout`策略。因为用于 `normalize`的统计量估计本身就存在噪音

8. 如果我们的任务和另一个被广泛研究的任务相似，那么通过复制之前研究中已知的性能良好的模型和算法，可能会得到很好的效果

    * 你可以从该任务中复制一个训练好的模型。如从`ImageNet`上训练好的卷积网络的特征来解决其他计算机视觉任务

9. 对于是否使用无监督学习，和特定领域有关

    * 对于某些领域，如自然语言处理，能大大受益于无监督学习技术
    * 在其他领域，目前无监督学习并没有带来好处
    * 如果你所处理的应用，无监督学习是非常重要的，那么将其包含在第一个端到端的基准中；否则只有在解决无监督问题时，才第一次尝试使用无监督学习


## 三、决定是否收集更多数据

1. 建立第一个端到端的系统后，就可以度量算法的性能并决定如何改进算法

    * 很多新手忍不住尝试很多不同的算法来改进
    * 实际上，收集更多的数据往往比改进学习算法要有用的多

2. 决定是否需要收集更多数据的标准：

    * 首先：确定训练集上的性能可否接受。如果模型在训练集上的性能就很差，那么没必要收集更多的数据。

        * 此时可以尝试增加更多的网络层
        * 或者每层增加更多的隐单元从而增加模型的规模
        * 也可以尝试调整学习率等超参数来改进算法
        * 如果这些都不行，则说明问题可能源自训练数据的质量：数据包含太多噪声，或者数据未能包含预测输出所需要的正确输入。此时我们需要重新开始收集干净的数据，或者收集特征更丰富的数据

    * 如果模型在训练集上的性能可以接受，那么我们开始度量测试集上的性能。

    * 如果测试集上的性能也可以接受，则任务完成

    * 如果测试集上的性能比训练集的要差得多，则收集更多的数据时最有效的解决方案之一

    * 此时主要考虑三个要素：

        * 收集更多数据的代价和可行性
        * 其他方法降低测试误差的代价和可行性
        * 增加数据数量能否显著提升测试集性能


3. 如果增加数据数量代价太大，那么一个替代的方案是降低模型规模，或者改进正则化（调整超参数、或者加入正则化策略）

    * 如果调整正则化参数之后，训练集性能和测试集性能之间的差距还是无法接受，则只能收集更多的数据

4. 当决定增加数据数量时，还需要确定收集多少数据。可以绘制曲线来显式训练集规模和泛化误差之间的关系

    * 根据曲线的延伸，可以预测还需要多少训练数据来到达一定的性能
    * 通常加入小比例的样本不会对泛化误差产生显著的影响。因此建议在对数尺度上考虑训练集的大小，以及增加的数据数量

5. 如果收集更多的数据是不可行的（成本太高无法实现，或者无法改进泛化误差），那么改进泛化误差的唯一方法是：改进学习算法本身

    * 这是属于研究领域，并不是对实践者的建议


## 四、选择超参数

1. 大部分深度学习算法都有许多超参数来控制不同方面的算法表现

    * 有的超参数会影响算法运行的时间和存储成本
    * 有的超参数会影响学习到的模型质量，以及在新输入上推断正确结果的能力

2. 有两种选择超参数的方法：

    * 手动选择。手动选择超参数需要了解超参数做了些什么，以及机器学习模型如何才能取得良好的泛化
    * 自动选择。自动选择超参数算法不需要你了解超参数做了什么以及机器学习模型如何才能取得零号的泛化，但是它往往需要更高的计算成本


### 4.1 手动调整超参数

1. 手动设置超参数：

我们必须了解超参数、训练误差、泛化误差、计算资源（内存和运行时间） 之间的关系。这要求我们切实了解一个学习算法有效容量的基本概念

2. 手动搜索超参数的任务是：在给定运行时间和内存预算范围的条件下，最小化泛化误差

    * 我们不讨论超参数对于运行时间和内存的影响，因为它们高度依赖于平台

3. 手动搜索超参数的主要目标是：调整模型的有效容量以匹配任务的复杂性

    * 模型的有效容量受限于三个因素：

        * 模型的表示容量。更多的网络层、每层更多的隐单元的模型具有更大的容量（能表达更复杂的函数）
        * 学习算法成功最小化训练模型代价函数的能力
        * 训练过程正则化模型的程度

    * 模型的表示容量并不是越高越好。如果无法找到合适的代价函数来最小化训练代价、或者正则化项排除了某些合适的函数，那么即使模型的表达能力再强，也无法学习出合适的函数。


4. 如果以超参数为自变量，泛化误差为因变量。那么会在的曲线通常会表现为 U 形

    * 在某个极端情况下，超参数对应着低容量（并不是超参数越小，模型容量越低；也可能是相反的情况）。此时泛化误差由于训练误差较大而很高。这就是欠拟合

    * 在另一个极端情况下，超参数对应着高容量，此时泛化误差也很大。这就是过拟合

        * 过拟合中，泛化误差较大的原因是：虽然此时训练误差较小，但是训练误差和测试误差之间的差距较大。

    * 最优的模型容量位于曲线中间的某个位置


5. 对于某些超参数，当超参数值太大时，会发生过拟合。如中间层隐单元的数量，数量越大，模型容量越高，也更容易发生过拟合。

对于某些超参数，当超参数值太小时，也会发生过拟合。如<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 1181 858.4" width="2.743ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" id="E10-MJMATHI-4C" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E10-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E10-MJMATHI-4C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="681" xlink:href="#E10-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-9" type="math/tex">L2</script>正则化的权重系数，系数为0，表示没有正则化，此时很容易过拟合。

6. 并不是每个超参数都对应着完整的 U 形曲线

    * 很多超参数是离散的，如中间层隐单元的数量，或者 `maxout`单元中线性片段的数目
    * 有些超参数甚至是二值的。如是否决定对输入特征进行标准化这个布尔值的超参数
    * 有些超参数可能有最小值或者最大值

7. 学习率可能是最重要的超参数

    * 如果你只有时间来调整一个超参数，那么就调整学习率

    * 相比其他超参数，学习率以一种更复杂的方式控制模型的有效容量：

        * 当学习率大小适当时，模型的有效容量最高
        * 当学习率过大时，梯度下降可能会不经意地增加而非减少训练误差。在理想的二次情况下，如果学习率是最佳值的两倍时，会发生这种情况
        * 当学习率太小时，训练不仅会很慢，还有可能永久停留在一个很高的训练误差。对于这种情况我们知之甚少（但是我们可以知道这种情况不会发生在一个凸损失函数中）

    * 学习率关于训练误差具有 U 形曲线。泛化误差也是类似的 U 形曲线，但是正则化作用在学习率过大或者过小处比较复杂

    ![man_search](../imgs/dl_practical/man_search.PNG)


8. 调整学习率以外的其他参数时，需要同时监测训练误差和测试误差，从而判断模型是否过拟合或者欠拟合，然后适当调整其容量

    * 如果训练集错误率大于目标错误率（这个根据任务背景人工指定），那么只能增加模型容量以改进模型。但是这增加了模型的计算代价

    * 如果测试集错误率大于目标错误率，则有两个方法：

        * 如果训练误差较小（这说明模型容量较大），则表明测试误差取决于训练误差与测试误差之间的差距。要减少这个差距，我们可以改变正则化超参数，以减少有效的模型容量
        * 如果训练误差较大（者说明模型容量较小），那么也只能增加模型容量以改进模型


9. 通常最佳性能来自于正则化很好的大规模模型，如使用`Dropout`的神经网络

10. 大部分超参数可以推论出是否增加或者减少模型容量，部分示例如下：
<figure><table><thead><tr><th style="text-align:center;">超参数</th><th style="text-align:center;">容量何时增加</th><th style="text-align:center;">原因</th><th style="text-align:center;">注意事项</th></tr></thead><tbody><tr><td style="text-align:center;">隐单元数量</td><td style="text-align:center;">增加</td><td style="text-align:center;">增加隐单元数量会增加模型的表示能力</td><td style="text-align:center;">几乎模型每个操作所需要的时间和内存代价都会随隐单元数量的增加而增加</td></tr><tr><td style="text-align:center;">学习率</td><td style="text-align:center;">调至最优</td><td style="text-align:center;">不正确的学习率，不管是太高还是太低都会由于优化失败而导致低的有效容量的模型</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">卷积核宽度</td><td style="text-align:center;">增加</td><td style="text-align:center;">增加卷积核宽度会增加模型的参数数量</td><td style="text-align:center;">较宽的卷积核导致较窄的输出尺寸，除非使用隐式零填充来减少此影响，否则会降低模型容量。较宽的卷积核需要更多的内存来存储参数，并增加运行时间</td></tr><tr><td style="text-align:center;">隐式零填充</td><td style="text-align:center;">增加</td><td style="text-align:center;">在卷积之前隐式添加零能保持较大尺寸的表示</td><td style="text-align:center;">大多数操作的时间和内存代价会增加</td></tr><tr><td style="text-align:center;">权重衰减系数</td><td style="text-align:center;">降低</td><td style="text-align:center;">降低权重衰减系数使得模型参数可以自由地变大</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">dropout 比率</td><td style="text-align:center;">降低</td><td style="text-align:center;">较少地丢弃单元可能更多的让单元彼此“协力”来适应训练集</td><td style="text-align:center;"></td></tr></tbody></table></figure>
11. 手动调整超参数时不要忘记最终目标：提升测试集性能

    * 加入正则化只是实现这个目标的一种方法
    * 如果训练误差很低，也可以通过收集更多的训练数据来减少泛化误差。如果训练误差太大，则收集更多的训练数据就没有意义。
    * 实践中的一种暴力方法是：不断提高模型容量和训练集的大小。这种方法增加了计算代价，只有在拥有充足的计算资源时才可行


### 4.2 自动超参数优化算法

1. 理想的学习算法应该是只需要输入一个数据集，然后就可以输出学习的函数而不需要人工干预调整超参数

    * 一些流行的算法如逻辑回归、支持向量机，其流行的部分原因是：这类算法只需要调整一到两个超参数，而且性能也不错
    * 某些情况下，神经网络只需要调整少量的超参数就能达到不错的性能；但是大多数情况下需要调整更多的超参数

2. 原则上可以开发出封装了学习算法的超参数优化算法，并自动选择其超参数

    * 超参数优化算法往往有自己的超参数（如每个超参数的取值范围），这将问题变得更复杂
    * 我们可以人工选择参数优化算法这一级的超参数，因为这一级的超参数通常更容易选择


### 4.3 网格搜索

1. 当只有三个或者更少的超参数时，常见的超参数搜索方法是：网格搜索

    * 对于每个超参数，选择一个较小的有限值集合去搜索
    * 然后这些超参数笛卡尔乘积得到多组超参数
    * 网格搜索使用每一组超参数训练模型，挑选验证集误差最小的超参数作为最好的超参数

2. 如何确定搜索集合的范围？

    * 如果超参数是数值，则搜索集合的最小、最大元素可以基于先前相似实验的经验保守地挑选出来
    * 如果超参数是离散的，则直接使用离散值

3. 通常网格搜索会在对数尺度下挑选合适的值

4. 通常重复进行网格搜索时，效果会更好。假设在集合 `{-1,0,1}`上网格搜索超参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 640 607.1" width="1.486ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" id="E22-MJMATHI-3B1" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E22-MJMATHI-3B1" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-21" type="math/tex">\alpha</script>

    * 如果找到的最佳值是 1，那么说明我们低估了<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 640 607.1" width="1.486ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" id="E22-MJMATHI-3B1" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E22-MJMATHI-3B1" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-21" type="math/tex">\alpha</script>的取值范围。此时重新在 `{1,2,3}` 上搜索
    * 如果找到的最佳值是 0，那么我们可以细化搜索范围以改进估计。此时重新在 `{-0.1,0,0.1}` 上搜索

5. 网格搜索的一个明显问题时：计算代价随着超参数数量呈指数级增长。

    * 如果有<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 878 607.1" width="2.039ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E13-MJMATHI-6D" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E13-MJMATHI-6D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-12" type="math/tex">m</script>个超参数，每个最多取<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 600 607.1" width="1.394ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E14-MJMATHI-6E" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E14-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-13" type="math/tex">n</script>个值，那么所需的试验数将是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 2861.8 1109.7" width="6.647ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z" id="E15-MJMATHI-4F" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E15-MJMAIN-28" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E15-MJMATHI-6E" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E15-MJMATHI-6D" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E15-MJMAIN-29" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E15-MJMATHI-4F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="763" xlink:href="#E15-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1152,0)"><use x="0" xlink:href="#E15-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="848" xlink:href="#E15-MJMATHI-6D" xmlns:xlink="http://www.w3.org/1999/xlink" y="513"></use></g><use x="2472" xlink:href="#E15-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-14" type="math/tex">O(n^m)</script>。虽然我们可以并行试验，但是指数级增长的计算代价仍然不可行


### 4.4 随机搜索

1. 随机搜索是一种可以替代网格搜索的方法，它编程简单、使用方便、能更快收敛到超参数的良好取值：

    * 首先为每个超参数定义一个边缘分布，如伯努利分布（对应着二元超参数）或者对数尺度上的均匀分布（对应着正实值超参数）
    * 然后假设超参数之间相互独立，从各分布中抽样出一组超参数。
    * 使用这组超参数训练模型
    * 经过多次抽样 -> 训练过程，挑选验证集误差最小的超参数作为最好的超参数

2. 随机搜索的优点：

    * 不需要离散化超参数的值，也不需要限定超参数的取值范围。这允许我们在一个更大的集合上进行搜索
    * 当某些超参数对于性能没有显著影响时，随机搜索相比于网格搜索指数级地高效，它能更快的减小验证集误差

3. 与网格搜索一样，我们通常会基于前一次运行结果来重复运行下一个版本的随机搜索

4. 随机搜索比网格搜索更快的找到良好超参数的原因是：没有浪费的实验

    * 在网格搜索中，两次实验之间只会改变一个超参数 （假设为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -806.1 573 1059.4" width="1.331ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z" id="E20-MJMATHI-3B2" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E20-MJMATHI-3B2" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-19" type="math/tex">\beta</script>）的值，而其他超参数的值保持不变。如果这个超参数<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -806.1 573 1059.4" width="1.331ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z" id="E20-MJMATHI-3B2" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E20-MJMATHI-3B2" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-19" type="math/tex">\beta</script>的值对于验证集误差没有明显区别，那么网格搜索相当于进行了两个重复的实验

    * 在随机搜索中，两次实验之间，所有的超参数值都不会相等（因为每个超参数的值都是从它们的分布函数中随机采样而来）。因此不大可能会出现两个重复的实验

    * 如果<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -806.1 573 1059.4" width="1.331ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z" id="E20-MJMATHI-3B2" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E20-MJMATHI-3B2" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-19" type="math/tex">\beta</script>超参数与泛化误差无关，那么不同的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -806.1 573 1059.4" width="1.331ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z" id="E20-MJMATHI-3B2" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E20-MJMATHI-3B2" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-19" type="math/tex">\beta</script>值：

        * 在网格搜索中，不同<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -806.1 573 1059.4" width="1.331ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z" id="E20-MJMATHI-3B2" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E20-MJMATHI-3B2" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-19" type="math/tex">\beta</script>值、相同的其他超参数值，会导致大量的重复实验
        * 在随机搜索中，其他超参数值每次也都不同，因此不大可能出现两个重复的实验（除非所有的超参数都与泛化误差无关）



### 4.5 基于模型的超参数优化

1. 超参数搜索问题可以转化为一个优化问题：

    * 决策变量是超参数
    * 优化的代价是超参数训练出来的模型在验证集上的误差
    * 在简化的设定下，可以计算验证集上可导的误差函数关于超参数的梯度，然后基于这个梯度进行更新

2. 实际上，大多数问题中，超参数的梯度是不可用的

    * 一方面可能是因为因为高额的计算代价和存储成本。因为你需要计算非常多的超参数才能获得一系列的超参数的导数（这就要求你运行非常多轮次的算法）
    * 另一方面可能是因为验证集误差在超参数上本质不可导（如超参数时离散值的情况）

3. 为了弥补超参数梯度的缺失，我们可以使用贝叶斯回归模型来估计每个超参数的验证集误差的期望和该期望的不确定性（贝叶斯回归模型不需要使用梯度）

    * 目前无法明确的确定：贝叶斯超参数优化是否有效。实际上，它有时表现得像一个人类专家，但是有时候又发生灾难的失误。目前该方法还不够成熟或可靠

4. 大部分超参数优化算法比随机搜索更复杂，并且具有一个共同的缺点：在获取任何有效的超参数信息之前，你必须完整运行整个训练过程

    * 这种做法是相当低效的。实际上人类手动搜索之前，可以很早就判断某些超参数组合是否是完全病态的


## 五、调试策略

1. 当一个机器学习系统效果不好时，很难判断效果不好的原因是算法本身，还是算法实现错误。由于各种原因，机器学习系统很难调试

    * 大多数情况下，我们不能提前知道算法的行为

        * 实际上，使用机器学习的出发点是：机器学习会发现一些我们无法发现的有用的行为
        * 如果我们在一个新的分类任务上训练一个神经网络，它达到了 5% 的测试误差。我们无法直接知道：这是期望的结果，还是次优的结果？

    * 大部分机器学习模型有多个自适应的部分

        * 如果某个部分失效了，那么其他部分仍然可以自适应这种状况，并获得大致可接受的性能
        * 比如在多层神经网络中，假设我们在梯度下降中对偏置更新时犯了一个错误<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 4054 858.4" width="9.416ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" id="E21-MJMATHI-62" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E21-MJMAIN-3D" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E21-MJMAIN-2212" stroke-width="0"></path><path d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" id="E21-MJMATHI-3B1" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E21-MJMATHI-62" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="706" xlink:href="#E21-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1762" xlink:href="#E21-MJMATHI-62" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2413" xlink:href="#E21-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3414" xlink:href="#E21-MJMATHI-3B1" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-20" type="math/tex">b=b-\alpha</script>（错误原因：没有使用梯度。其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 640 607.1" width="1.486ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" id="E22-MJMATHI-3B1" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E22-MJMATHI-3B1" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-21" type="math/tex">\alpha</script>为学习率）。这个错误导致偏置在学习过程中不断减小。但是只是检查模型输出的话，这个错误并不是显而易见的。因为权重<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 1189 858.4" width="2.762ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M915 686L1052 683Q1142 683 1157 686H1164V624H1073L957 320Q930 249 900 170T855 52T839 10Q834 0 826 -5Q821 -7 799 -7H792Q777 -7 772 -5T759 10Q759 11 748 39T716 122T676 228L594 442L512 228Q486 159 455 78Q433 19 428 9T416 -5Q411 -7 389 -7H379Q356 -7 349 10Q349 12 334 51T288 170T231 320L116 624H24V686H35Q44 683 183 683Q331 683 355 686H368V624H323Q278 624 278 623L437 207L499 369L561 531L526 624H434V686H445Q454 683 593 683Q741 683 765 686H778V624H733Q688 624 688 623L847 207Q848 207 927 415T1006 624H905V686H915Z" id="E45-MJMAINB-57" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E45-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-44" type="math/tex">\mathbf W</script>可以自适应的补偿偏置<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 429 858.4" width="0.996ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" id="E24-MJMATHI-62" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E24-MJMATHI-62" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-23" type="math/tex">b</script>的错误


2. 大部分神经网络的调试策略都是解决上述两个难点的一个或者两个

    * 我们可以设计一种足够简单的情况，能够提前得到正确结果，判断模型预测是否与之相符
    * 我们可以设计一个测试（类似于 `UnitTest`），独立检查神经网络实现的各个部分

3. 一些重要的调试方法如下：

    * 可视化计算中模型的行为：直接观察机器学习模型运行机器任务，有助于确定其达到的量化性能数据是否看上去合理

        * 仅仅评估模型性能可能是最具破坏性的错误之一，因为它会使你在系统出问题时误以为系统运行良好

    * 可视化那些最严重的错误：大多数模型能够输出运行任务时的某种置信度（如基于`softmax`函数输出层的分类器给每个类分配了一个概率）。如果某个样本被错误的分类，而且其分类置信度很低，那么可以检查这些样本的问题

    * 根据训练和测试误差检测软件：通常我们很难确定底层软件是否正确实现，而测试和训练误差提供了一些线索

        * 如果训练误差较低，而测试误差较高，那么很可能是由于算法过拟合。也有可能是软件错误，导致测试误差未能正确地度量
        * 如果训练误差和测试误差都很高，那么很难确定是由于软件错误，还是由于算法模型的欠拟合。此时需要进一步测试，如下所述

    * 监控激活函数值和梯度的直方图：可视化激活函数值和梯度的统计量往往是有用的。

        * 隐单元的激活函数值告诉我们：该单元是否饱和，或者它们饱和的频率如何（如多久关闭一次，是否永远关闭，以及采用双曲正切单元时饱和的程度）
        * 梯度的统计量告诉我们：梯度是否快速的增长或者快速的消失
        * 参数的梯度的量级和参数的量级也有意义：我们希望参数在一个小批量更新中变化的幅度是参数量值的 1% 这样的级别（而不是 50% 或者 0.0001%，这两者要么导致参数移动太快，要么太慢）
        * 如果数据是稀疏的（如自然语言），则有些参数可能是很少更新的，检测时需要注意


4. 许多深度学习算法为每一步的结果产生了某种保证。其中包括：

    * 目标函数值确保在算法的迭代步中不会增加

    * 某些变量的导数在算法的每一步中都是 0

    * 所有变量的梯度在收敛时，会变为 0

    >     > 

    > 由于计算机存储浮点数的舍入误差，这些条件可能会有误差




如果违反了这些保证，那么一定是软件错误


### 5.1 梯度检查

1. 比较反向传播导数和数值导数：如果我们正在使用一个软件框架或者库，那么必须定义 `bprop`方法，常见的错误原因是未能正确的实现梯度表达。验证该错误的一个方法是：比较实现的自动求导和通过有限差分计算的导数
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="5.379ex" role="img" style="vertical-align: -1.756ex;" viewbox="0 -1560 11297.4 2315.9" width="26.239ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" id="E1-MJMATHI-64" stroke-width="0"></path><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E1-MJMATHI-66" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E1-MJMAIN-28" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E1-MJMATHI-78" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E1-MJMAIN-29" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E1-MJMAIN-3D" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E1-MJMAIN-2B" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E1-MJMATHI-68" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E1-MJMAIN-2212" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="2543" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E1-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E1-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1073" xlink:href="#E1-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1462" xlink:href="#E1-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2034" xlink:href="#E1-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(724,-686)"><use x="0" xlink:href="#E1-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E1-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g><use x="3060" xlink:href="#E1-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(3838,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="6940" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E1-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="550" xlink:href="#E1-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="939" xlink:href="#E1-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1733" xlink:href="#E1-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2733" xlink:href="#E1-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3309" xlink:href="#E1-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3920" xlink:href="#E1-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4920" xlink:href="#E1-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5470" xlink:href="#E1-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5859" xlink:href="#E1-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6431" xlink:href="#E1-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use x="3182" xlink:href="#E1-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="-686"></use></g></g></g></svg></span></span><script id="MathJax-Element-1" type="math/tex; mode=display">\frac{df(x)}{dx}=\frac{f(x+h)-f(x)}{h}</script>
或者采用中心差分法：
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="5.379ex" role="img" style="vertical-align: -1.756ex;" viewbox="0 -1560 13095.9 2315.9" width="30.416ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" id="E2-MJMATHI-64" stroke-width="0"></path><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E2-MJMATHI-66" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E2-MJMAIN-28" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E2-MJMATHI-78" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E2-MJMAIN-29" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E2-MJMAIN-3D" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E2-MJMAIN-2B" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E2-MJMATHI-68" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E2-MJMAIN-2212" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E2-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="2543" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E2-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E2-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1073" xlink:href="#E2-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1462" xlink:href="#E2-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2034" xlink:href="#E2-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(724,-686)"><use x="0" xlink:href="#E2-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E2-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g><use x="3060" xlink:href="#E2-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(3838,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="8739" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E2-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="550" xlink:href="#E2-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="939" xlink:href="#E2-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1733" xlink:href="#E2-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2733" xlink:href="#E2-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3309" xlink:href="#E2-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3920" xlink:href="#E2-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4920" xlink:href="#E2-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5470" xlink:href="#E2-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5859" xlink:href="#E2-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6654" xlink:href="#E2-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7654" xlink:href="#E2-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="8230" xlink:href="#E2-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(3831,-686)"><use x="0" xlink:href="#E2-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="500" xlink:href="#E2-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></g></svg></span></span><script id="MathJax-Element-2" type="math/tex; mode=display">\frac{df(x)}{dx}=\frac{f(x+h)-f(x-h)}{2h}</script>
其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 406 607.1" width="0.943ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M227 -11Q149 -11 95 41T40 174Q40 262 87 322Q121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411Q382 385 341 385H325H312Q191 385 154 277L150 265H327Q340 256 340 246Q340 228 320 219H138V217Q128 187 128 143Q128 77 160 52T231 26Q258 26 284 36T326 57T343 68Q350 68 354 58T358 39Q358 36 357 35Q354 31 337 21T289 0T227 -11Z" id="E25-MJMATHI-3F5" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E25-MJMATHI-3F5" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-24" type="math/tex">\epsilon</script>必须足够大，从而确保不会由于有限精度问题产生舍入误差

    * 如果梯度是雅克比矩阵（输出为向量，输入也是向量），则我们可以多次使用有限差分法来评估所有的偏导数

    * 通常推荐使用中心差分法，因为根据泰勒展开，有：
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="11.449ex" role="img" style="vertical-align: -7.826ex;" viewbox="0 -1560 37191.8 4929.4" width="86.381ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E3-MJMATHI-66" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E3-MJMAIN-28" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E3-MJMATHI-78" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E3-MJMAIN-2B" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E3-MJMATHI-68" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E3-MJMAIN-29" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E3-MJMAIN-2212" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E3-MJMAIN-3D" stroke-width="0"></path><path d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" id="E3-MJMAIN-2032" stroke-width="0"></path><path d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z" id="E3-MJMATHI-4F" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E3-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11562,0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="6940" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E3-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="550" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="939" xlink:href="#E3-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1733" xlink:href="#E3-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2733" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3309" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3920" xlink:href="#E3-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4920" xlink:href="#E3-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5470" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5859" xlink:href="#E3-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6431" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use x="3182" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="-686"></use></g><use x="7458" xlink:href="#E3-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(8514,0)"><use x="0" xlink:href="#E3-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E3-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="583"></use></g><use x="9376" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="9765" xlink:href="#E3-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="10337" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="10949" xlink:href="#E3-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="11949" xlink:href="#E3-MJMATHI-4F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="12712" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="13101" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="13677" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(10436,-2594)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="8739" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E3-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="550" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="939" xlink:href="#E3-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1733" xlink:href="#E3-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2733" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3309" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3920" xlink:href="#E3-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4920" xlink:href="#E3-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5470" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5859" xlink:href="#E3-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6654" xlink:href="#E3-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7654" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="8230" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(3831,-686)"><use x="0" xlink:href="#E3-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="500" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g><use x="9257" xlink:href="#E3-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(10312,0)"><use x="0" xlink:href="#E3-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E3-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="583"></use></g><use x="11175" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="11564" xlink:href="#E3-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="12136" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="12747" xlink:href="#E3-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="13747" xlink:href="#E3-MJMATHI-4F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="14510" xlink:href="#E3-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(14899,0)"><use x="0" xlink:href="#E3-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="814" xlink:href="#E3-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="583"></use></g><use x="15929" xlink:href="#E3-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span></span><script id="MathJax-Element-3" type="math/tex; mode=display">\frac{f(x+h)-f(x)}{h}=f^\prime(x)+O(h)\\ \frac{f(x+h)-f(x-h)}{2h}=f^\prime(x)+O(h^2)</script>
    使用中心差分法的误差更小。


2. 理论上进行梯度检查很简单，就是把解析的梯度和数值计算的梯度进行比较。但是实际操作过程中，这个过程复杂且容易出错。

3. 使用中心化公式来计算数值梯度。

通常我们计算数值梯度时，采用：
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="5.379ex" role="img" style="vertical-align: -1.756ex;" viewbox="0 -1560 11297.4 2315.9" width="26.239ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" id="E4-MJMATHI-64" stroke-width="0"></path><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E4-MJMATHI-66" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E4-MJMAIN-28" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E4-MJMATHI-78" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E4-MJMAIN-29" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E4-MJMAIN-3D" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E4-MJMAIN-2B" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E4-MJMATHI-68" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E4-MJMAIN-2212" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="2543" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E4-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E4-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1073" xlink:href="#E4-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1462" xlink:href="#E4-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2034" xlink:href="#E4-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(724,-686)"><use x="0" xlink:href="#E4-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E4-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g><use x="3060" xlink:href="#E4-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(3838,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="6940" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E4-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="550" xlink:href="#E4-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="939" xlink:href="#E4-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1733" xlink:href="#E4-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2733" xlink:href="#E4-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3309" xlink:href="#E4-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3920" xlink:href="#E4-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4920" xlink:href="#E4-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5470" xlink:href="#E4-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5859" xlink:href="#E4-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6431" xlink:href="#E4-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use x="3182" xlink:href="#E4-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="-686"></use></g></g></g></svg></span></span><script id="MathJax-Element-4" type="math/tex; mode=display">\frac{df(x)}{dx}=\frac{f(x+h)-f(x)}{h}</script>
其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 576 858.4" width="1.338ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E40-MJMATHI-68" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E40-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-39" type="math/tex">h</script>为一个很小的数字，在实践过程中近似为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 2003.7 1059.4" width="4.654ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E27-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E27-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E27-MJMAIN-2212" stroke-width="0"></path><path d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" id="E27-MJMAIN-35" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E27-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E27-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E27-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E27-MJMAIN-35" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span><script id="MathJax-Element-26" type="math/tex">10^{-5}</script>。但是实践中证明，使用中心化公式效果更好：
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="5.379ex" role="img" style="vertical-align: -1.756ex;" viewbox="0 -1560 13095.9 2315.9" width="30.416ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" id="E5-MJMATHI-64" stroke-width="0"></path><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E5-MJMATHI-66" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E5-MJMAIN-28" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E5-MJMATHI-78" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E5-MJMAIN-29" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E5-MJMAIN-3D" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E5-MJMAIN-2B" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E5-MJMATHI-68" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E5-MJMAIN-2212" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E5-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="2543" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E5-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E5-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1073" xlink:href="#E5-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1462" xlink:href="#E5-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2034" xlink:href="#E5-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(724,-686)"><use x="0" xlink:href="#E5-MJMATHI-64" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="523" xlink:href="#E5-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g><use x="3060" xlink:href="#E5-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(3838,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="8739" x="0" y="220"></rect><g transform="translate(60,715)"><use x="0" xlink:href="#E5-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="550" xlink:href="#E5-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="939" xlink:href="#E5-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1733" xlink:href="#E5-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2733" xlink:href="#E5-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3309" xlink:href="#E5-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3920" xlink:href="#E5-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4920" xlink:href="#E5-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5470" xlink:href="#E5-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5859" xlink:href="#E5-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6654" xlink:href="#E5-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7654" xlink:href="#E5-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="8230" xlink:href="#E5-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(3831,-686)"><use x="0" xlink:href="#E5-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="500" xlink:href="#E5-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></g></svg></span></span><script id="MathJax-Element-5" type="math/tex; mode=display">\frac{df(x)}{dx}=\frac{f(x+h)-f(x-h)}{2h}</script>
    * 缺点：在检查梯度的每个维度时，需要计算两次损失函数
    * 优点：梯度的数值求解结果会准确的多。中心化公式的近似误差为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.811ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -906.7 2570.6 1210.2" width="5.97ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z" id="E28-MJMATHI-4F" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E28-MJMAIN-28" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E28-MJMATHI-68" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E28-MJMAIN-32" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E28-MJMAIN-29" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E28-MJMATHI-4F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="763" xlink:href="#E28-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1152,0)"><use x="0" xlink:href="#E28-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="814" xlink:href="#E28-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="513"></use></g><use x="2181" xlink:href="#E28-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-27" type="math/tex">O(h^2)</script>，而前一个公式的近似误差为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 2117 1109.7" width="4.917ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z" id="E29-MJMATHI-4F" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E29-MJMAIN-28" stroke-width="0"></path><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E29-MJMATHI-68" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E29-MJMAIN-29" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E29-MJMATHI-4F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="763" xlink:href="#E29-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1152" xlink:href="#E29-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1728" xlink:href="#E29-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-28" type="math/tex">O(h)</script>

4. 使用相对误差来比较。对于数值梯度<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 1014.3 1109.7" width="2.356ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E30-MJMATHI-66" stroke-width="0"></path><path d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" id="E30-MJMAIN-2032" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E30-MJMATHI-6E" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E30-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E30-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="444"></use><use transform="scale(0.707)" x="692" xlink:href="#E30-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="-211"></use></g></svg></span><script id="MathJax-Element-29" type="math/tex">f^\prime_n</script>和解析梯度<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 964.1 1109.7" width="2.239ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E31-MJMATHI-66" stroke-width="0"></path><path d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" id="E31-MJMAIN-2032" stroke-width="0"></path><path d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" id="E31-MJMATHI-61" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E31-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E31-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="444"></use><use transform="scale(0.707)" x="692" xlink:href="#E31-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="-209"></use></g></svg></span><script id="MathJax-Element-30" type="math/tex">f^\prime_a</script>，通常都是比较其相对误差而不是绝对误差来判断数值计算得到的梯度是否正确：
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="6.079ex" role="img" style="vertical-align: -2.456ex;" viewbox="0 -1560 8336.5 2617.5" width="19.362ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E7-MJMATHI-73" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E7-MJMAIN-3D" stroke-width="0"></path><path d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" id="E7-MJMAIN-7C" stroke-width="0"></path><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E7-MJMATHI-66" stroke-width="0"></path><path d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" id="E7-MJMAIN-2032" stroke-width="0"></path><path d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" id="E7-MJMATHI-61" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E7-MJMAIN-2212" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E7-MJMATHI-6E" stroke-width="0"></path><path d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" id="E7-MJMAIN-6D" stroke-width="0"></path><path d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z" id="E7-MJMAIN-61" stroke-width="0"></path><path d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z" id="E7-MJMAIN-78" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E7-MJMAIN-28" stroke-width="0"></path><path d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" id="E7-MJMAIN-2C" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E7-MJMAIN-29" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E7-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="746" xlink:href="#E7-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1524,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="6293" x="0" y="220"></rect><g transform="translate(1268,714)"><use x="0" xlink:href="#E7-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(278,0)"><use x="0" xlink:href="#E7-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E7-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="444"></use><use transform="scale(0.707)" x="692" xlink:href="#E7-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="-209"></use></g><use x="1464" xlink:href="#E7-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(2464,0)"><use x="0" xlink:href="#E7-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E7-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="444"></use><use transform="scale(0.707)" x="692" xlink:href="#E7-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="-211"></use></g><use x="3478" xlink:href="#E7-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(60,-716)"><use xlink:href="#E7-MJMAIN-6D" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="833" xlink:href="#E7-MJMAIN-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1333" xlink:href="#E7-MJMAIN-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1861" xlink:href="#E7-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2250" xlink:href="#E7-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(2528,0)"><use x="0" xlink:href="#E7-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E7-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="444"></use><use transform="scale(0.707)" x="692" xlink:href="#E7-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="-209"></use></g><use x="3492" xlink:href="#E7-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3770" xlink:href="#E7-MJMAIN-2C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4214" xlink:href="#E7-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(4492,0)"><use x="0" xlink:href="#E7-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="803" xlink:href="#E7-MJMAIN-2032" xmlns:xlink="http://www.w3.org/1999/xlink" y="444"></use><use transform="scale(0.707)" x="692" xlink:href="#E7-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="-211"></use></g><use x="5506" xlink:href="#E7-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5784" xlink:href="#E7-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></g></svg></span></span><script id="MathJax-Element-6" type="math/tex; mode=display">s=\frac{|f_a^\prime-f_n^\prime|}{\max(|f_a^\prime|,|f_n^\prime|)}</script>
    * 如果相对误差<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 3806.2 1059.4" width="8.84ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E32-MJMATHI-73" stroke-width="0"></path><path d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z" id="E32-MJMAIN-3E" stroke-width="0"></path><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E32-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E32-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E32-MJMAIN-2212" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E32-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E32-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="746" xlink:href="#E32-MJMAIN-3E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1802,0)"><use xlink:href="#E32-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E32-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E32-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E32-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></svg></span><script id="MathJax-Element-31" type="math/tex">s\gt 10^{-2}</script>，则通常意味着求解梯度可能出错
    * 如果相对误差<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 3806.2 1059.4" width="8.84ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E33-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E33-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E33-MJMAIN-2212" stroke-width="0"></path><path d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" id="E33-MJMAIN-34" stroke-width="0"></path><path d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z" id="E33-MJMAIN-3E" stroke-width="0"></path><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E33-MJMATHI-73" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E33-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E33-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E33-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E33-MJMAIN-34" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use x="2281" xlink:href="#E33-MJMAIN-3E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3337" xlink:href="#E33-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-32" type="math/tex">10^{-4}\gt s</script>，则对于有不可导点的目标函数时OK的，但是对于使用了`tanh/softmax`的目标函数，还是有点高
    * 如果相对误差<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 3806.2 1059.4" width="8.84ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E34-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E34-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E34-MJMAIN-2212" stroke-width="0"></path><path d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" id="E34-MJMAIN-37" stroke-width="0"></path><path d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z" id="E34-MJMAIN-3E" stroke-width="0"></path><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E34-MJMATHI-73" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E34-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E34-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E34-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E34-MJMAIN-37" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use x="2281" xlink:href="#E34-MJMAIN-3E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3337" xlink:href="#E34-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-33" type="math/tex">10^{-7}\gt s</script>，则求解梯度结果正确
    * 因为网络越深，相对误差就越高。因此对于一个 10 层网络的输入数据做梯度检查，那么<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 2003.7 1059.4" width="4.654ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E36-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E36-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E36-MJMAIN-2212" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E36-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E36-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E36-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E36-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E36-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span><script id="MathJax-Element-35" type="math/tex">10^{-2}</script>的相对误差可能就OK了，因为误差一直在累积

5. 使用双精度类型。当使用单精度浮点数来进行梯度检查时，即使梯度计算过程正确，相对误差也会很高（如<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 2003.7 1059.4" width="4.654ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E36-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E36-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E36-MJMAIN-2212" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E36-MJMAIN-32" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E36-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E36-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E36-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E36-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span><script id="MathJax-Element-35" type="math/tex">10^{-2}</script>）

6. 梯度检查时，一个导致不准确的原因是：不可导点。

    * 不可导点是目标函数不可导的部分，由于 relu 等函数的引入导致。

    * 解决方法是：使用更少的数据点。

        * 因为数据点越少，不可导点就越少，所以在计算有限差值近似时，横跨不可导点的几率就越小。
        * 另外如果你的梯度检查对 2-3 个数据点都有效，那么基本上对于整个 batch 数据进行梯度检查也没有问题。所以用少量的数据点，能让梯度检查更迅速有效


7. 谨慎设置步长<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 576 858.4" width="1.338ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E40-MJMATHI-68" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E40-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-39" type="math/tex">h</script>

    * 并不是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 576 858.4" width="1.338ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E40-MJMATHI-68" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E40-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-39" type="math/tex">h</script>越小越好。因为当<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 576 858.4" width="1.338ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E40-MJMATHI-68" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E40-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-39" type="math/tex">h</script>特别小时，可能会遇到数值精度问题。如果梯度检查不通过，可以尝试将<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 576 858.4" width="1.338ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" id="E40-MJMATHI-68" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E40-MJMATHI-68" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-39" type="math/tex">h</script>调到<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 2003.7 1059.4" width="4.654ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E41-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E41-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E41-MJMAIN-2212" stroke-width="0"></path><path d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" id="E41-MJMAIN-34" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E41-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E41-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E41-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E41-MJMAIN-34" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span><script id="MathJax-Element-40" type="math/tex">10^{-4}</script>或者<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 2003.7 1059.4" width="4.654ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E42-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E42-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E42-MJMAIN-2212" stroke-width="0"></path><path d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" id="E42-MJMAIN-36" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E42-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E42-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E42-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E42-MJMAIN-36" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span><script id="MathJax-Element-41" type="math/tex">10^{-6}</script>

8. 建议让网络预热一小段时间，等到损失函数开始下降之后在进行梯度检查

    * 第一次迭代就开始梯度检查的危险在于：此时可能处于不正常的边界情况，从而掩盖了梯度没有正确实现的事实。因为梯度检查是在参数空间中的一个特定的、单独的点上进行的。即使在该点上检查成功，也不能保证梯度实现是正确的。

9. 不要让正则化吞没数据

    * 通常损失函数为：数据损失+正则化损失之和。某些情况下，损失函数的梯度主要来源于正则化部分，此时就会掩盖掉数据损失梯度的不正确实现
    * 建议先关掉正则化对数据损失做单独检查，然后对正则化做单独检查

10. 关闭 dropout 和数据 augmentation

    * 梯度检查时，关闭网络中任何不确定的效果的操作，如随机 dropout，随机数据扩展。不然它们会在计算数值梯度时导致巨大误差

11. 检查少量的维度。由于梯度可以有上百万的参数，此时只能检查其中一些维度然后假设其他维度是正确的

    * 确保在所有不同的参数中都抽取一部分来梯度检查。比如<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.344ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -755.9 5346.4 1009.2" width="12.418ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M915 686L1052 683Q1142 683 1157 686H1164V624H1073L957 320Q930 249 900 170T855 52T839 10Q834 0 826 -5Q821 -7 799 -7H792Q777 -7 772 -5T759 10Q759 11 748 39T716 122T676 228L594 442L512 228Q486 159 455 78Q433 19 428 9T416 -5Q411 -7 389 -7H379Q356 -7 349 10Q349 12 334 51T288 170T231 320L116 624H24V686H35Q44 683 183 683Q331 683 355 686H368V624H323Q278 624 278 623L437 207L499 369L561 531L526 624H434V686H445Q454 683 593 683Q741 683 765 686H778V624H733Q688 624 688 623L847 207Q848 207 927 415T1006 624H905V686H915Z" id="E43-MJMAINB-57" stroke-width="0"></path><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E43-MJMAIN-31" stroke-width="0"></path><path d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" id="E43-MJMAIN-2C" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E43-MJMAIN-32" stroke-width="0"></path><path d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z" id="E43-MJMAIN-22EF" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E43-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1681" xlink:href="#E43-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use><use x="1642" xlink:href="#E43-MJMAIN-2C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(2087,0)"><use x="0" xlink:href="#E43-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1681" xlink:href="#E43-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="3729" xlink:href="#E43-MJMAIN-2C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4174" xlink:href="#E43-MJMAIN-22EF" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-42" type="math/tex">\mathbf W_1,\mathbf W_2,\cdots</script>这些权重矩阵中，每个矩阵抽取一部分来检查。
    * 不要将所有参数拼接成一个巨大的向量，然后从这个向量中随机抽取一些维度来检查

12. 只有在调试过程中进行梯度检验。不要在训练过程中执行梯度检验，因为非常耗计算资源。


### 5.2 学习过程检查

1. 拟合极小的数据集：

当训练集上有很大的误差时，我们需要确定问题是欠拟合，还是软件错误。尝试对一个小数据子集进行训练，然后确保能达到 0 的损失值。

    * 通常即使是极小模型也能保证很好的拟合一个足够小的数据集。如只有一个样本的分类数据，它可以通过正确设置输出层的偏置来拟合
    * 如果分类器不能正确标定一个单样本组成的训练集、自编码器无法成功再现一个单独的样本、生成模型无法一致的生成一个单独的样本，那么很有可能是由于软件错误
    * 这种测试可以推广到少量样本的小数据集上，不一定是只有一个样本的数据集
    * 进行这个训练时，最好让正则化强度为0，不然它会阻止得到0的损失
    * 如果不能通过这个检验，那么训练过程有问题。此时进行整个数据集的训练是没有意义的；如果能通过这个检验，那么也不保证训练过程没问题

2. 在训练神经网络时，应该跟踪多个重要数值

    * 这些数值输出的图表是观察训练进程的一个窗口，是直观理解不同超参数设置效果的工具

    * 通常<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-60-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 572 607.1" width="1.329ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E61-MJMATHI-78" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E61-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-60" type="math/tex">x</script>轴都是以周期 epoch 为单位，它衡量了训练中每个样本数据都被观察过次数的期望

        * 一个周期表示每个样本数据都被观察过了一次
        * 不要使用迭代次数。因为迭代次数与数据的 batch size 有关。而 batch size 可以任意设置


3. 第一个要跟踪的数值就是损失函数

![training_loss](../imgs/dl_practical/training_loss.PNG)

从左图中可见：

    * 过低的学习率（蓝色曲线）导致算法的损失函数下降近似线性的
    * 稍高一些的学习率（红色曲线） 会导致算法的损失函数看起来呈几何指数下降
    * 更高一些的学习率（绿色曲线）会让损失函数下降的更快，但是它使得损失函数停留在一个较高的水平位
    * 异常高的学习率（黄色曲线）会让损失函数上升

从右图可见：

    * 损失函数值曲线看起来比较合理，但是 batch size 可能有点小。因为损失值的噪音很大
    * 损失值的震荡程度和 batch size 有关。当 batch size=1 时，震荡会相对较大；而 batch size 为整个数据集大小时，震荡最小。因为每个梯度更新都是单调的优化损失函数

4. 在训练分类器时，第二个要跟踪的就是验证集和训练集的准确率。从该图标可以获知模型过拟合的程度

![training_loss2](../imgs/dl_practical/training_loss2.PNG)

    * 训练集准确率和验证集准确率之间的空隙指明了模型过拟合的程
    * 蓝色的验证集曲线相对于训练集，验证集的准确率低了很多。这说明模型有很强的过拟合。此时应该增大正则化强度或者收集更多的数据
    * 绿色的验证集曲线和训练集曲线如影随形，说明你的模型容量还不够大，发生了欠拟合。此时应该通过增加参数数量让模型更大一些。

5. 另一个应该跟踪的数值是：权重更新的相对值

假设权重为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -755.9 1189 858.4" width="2.762ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M915 686L1052 683Q1142 683 1157 686H1164V624H1073L957 320Q930 249 900 170T855 52T839 10Q834 0 826 -5Q821 -7 799 -7H792Q777 -7 772 -5T759 10Q759 11 748 39T716 122T676 228L594 442L512 228Q486 159 455 78Q433 19 428 9T416 -5Q411 -7 389 -7H379Q356 -7 349 10Q349 12 334 51T288 170T231 320L116 624H24V686H35Q44 683 183 683Q331 683 355 686H368V624H323Q278 624 278 623L437 207L499 369L561 531L526 624H434V686H445Q454 683 593 683Q741 683 765 686H778V624H733Q688 624 688 623L847 207Q848 207 927 415T1006 624H905V686H915Z" id="E45-MJMAINB-57" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E45-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-44" type="math/tex">\mathbf W</script>，更新的增量为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 8035.7 1109.7" width="18.664ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z" id="E46-MJMAIN-394" stroke-width="0"></path><path d="M915 686L1052 683Q1142 683 1157 686H1164V624H1073L957 320Q930 249 900 170T855 52T839 10Q834 0 826 -5Q821 -7 799 -7H792Q777 -7 772 -5T759 10Q759 11 748 39T716 122T676 228L594 442L512 228Q486 159 455 78Q433 19 428 9T416 -5Q411 -7 389 -7H379Q356 -7 349 10Q349 12 334 51T288 170T231 320L116 624H24V686H35Q44 683 183 683Q331 683 355 686H368V624H323Q278 624 278 623L437 207L499 369L561 531L526 624H434V686H445Q454 683 593 683Q741 683 765 686H778V624H733Q688 624 688 623L847 207Q848 207 927 415T1006 624H905V686H915Z" id="E46-MJMAINB-57" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E46-MJMAIN-3D" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E46-MJMAIN-2212" stroke-width="0"></path><path d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q156 442 175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336V326Q503 302 439 53Q381 -182 377 -189Q364 -216 332 -216Q319 -216 310 -208T299 -186Q299 -177 358 57L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E46-MJMATHI-3B7" stroke-width="0"></path><path d="M229 286Q216 420 216 436Q216 454 240 464Q241 464 245 464T251 465Q263 464 273 456T283 436Q283 419 277 356T270 286L328 328Q384 369 389 372T399 375Q412 375 423 365T435 338Q435 325 425 315Q420 312 357 282T289 250L355 219L425 184Q434 175 434 161Q434 146 425 136T401 125Q393 125 383 131T328 171L270 213Q283 79 283 63Q283 53 276 44T250 35Q231 35 224 44T216 63Q216 80 222 143T229 213L171 171Q115 130 110 127Q106 124 100 124Q87 124 76 134T64 161Q64 166 64 169T67 175T72 181T81 188T94 195T113 204T138 215T170 230T210 250L74 315Q65 324 65 338Q65 353 74 363T98 374Q106 374 116 368T171 328L229 286Z" id="E46-MJMAIN-2217" stroke-width="0"></path><path d="M46 676Q46 679 51 683H781Q786 679 786 676Q786 674 617 326T444 -26Q439 -33 416 -33T388 -26Q385 -22 216 326T46 676ZM697 596Q697 597 445 597T193 596Q195 591 319 336T445 80L697 596Z" id="E46-MJMAIN-2207" stroke-width="0"></path><path d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" id="E46-MJMATHI-4C" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E46-MJMAIN-394" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="833" xlink:href="#E46-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2299" xlink:href="#E46-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3355" xlink:href="#E46-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4133" xlink:href="#E46-MJMATHI-3B7" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4858" xlink:href="#E46-MJMAIN-2217" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(5581,0)"><use x="0" xlink:href="#E46-MJMAIN-2207" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1178" xlink:href="#E46-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="7354" xlink:href="#E46-MJMATHI-4C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-45" type="math/tex">\Delta \mathbf W=-\eta*\nabla_\mathbf WL</script>。<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.877ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -504.6 503 808.1" width="1.168ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q156 442 175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336V326Q503 302 439 53Q381 -182 377 -189Q364 -216 332 -216Q319 -216 310 -208T299 -186Q299 -177 358 57L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E47-MJMATHI-3B7" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E47-MJMATHI-3B7" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-46" type="math/tex">\eta</script>为学习率。那么权重更新的相对值为：
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="6.079ex" role="img" style="vertical-align: -2.456ex;" viewbox="0 -1560 5926.2 2617.5" width="13.764ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E8-MJMATHI-73" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E8-MJMAIN-3D" stroke-width="0"></path><path d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" id="E8-MJMAIN-7C" stroke-width="0"></path><path d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z" id="E8-MJMAIN-394" stroke-width="0"></path><path d="M915 686L1052 683Q1142 683 1157 686H1164V624H1073L957 320Q930 249 900 170T855 52T839 10Q834 0 826 -5Q821 -7 799 -7H792Q777 -7 772 -5T759 10Q759 11 748 39T716 122T676 228L594 442L512 228Q486 159 455 78Q433 19 428 9T416 -5Q411 -7 389 -7H379Q356 -7 349 10Q349 12 334 51T288 170T231 320L116 624H24V686H35Q44 683 183 683Q331 683 355 686H368V624H323Q278 624 278 623L437 207L499 369L561 531L526 624H434V686H445Q454 683 593 683Q741 683 765 686H778V624H733Q688 624 688 623L847 207Q848 207 927 415T1006 624H905V686H915Z" id="E8-MJMAINB-57" stroke-width="0"></path><path d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z" id="E8-MJMATHI-46" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E8-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="746" xlink:href="#E8-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1524,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="3883" x="0" y="220"></rect><g transform="translate(60,750)"><use x="0" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="278" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="556" xlink:href="#E8-MJMAIN-394" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1389" xlink:href="#E8-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2578" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(2856,0)"><use x="0" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="393" xlink:href="#E8-MJMATHI-46" xmlns:xlink="http://www.w3.org/1999/xlink" y="-403"></use></g></g><g transform="translate(476,-716)"><use x="0" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="278" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="556" xlink:href="#E8-MJMAINB-57" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1745" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(2023,0)"><use x="0" xlink:href="#E8-MJMAIN-7C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="393" xlink:href="#E8-MJMATHI-46" xmlns:xlink="http://www.w3.org/1999/xlink" y="-403"></use></g></g></g></g></g></svg></span></span><script id="MathJax-Element-7" type="math/tex; mode=display">s=\frac{||\Delta \mathbf W||_F}{||\mathbf W||_F}</script>
    * 这里的梯度是一个更新的梯度。如果多个 batch ，则每个 batch 更新一次就计算一次
    * 这个比例<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 469 607.1" width="1.089ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E60-MJMATHI-73" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E60-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-59" type="math/tex">s</script>应该在<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.461ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -956.9 2003.7 1059.4" width="4.654ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E49-MJMAIN-31" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E49-MJMAIN-30" stroke-width="0"></path><path d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" id="E49-MJMAIN-2212" stroke-width="0"></path><path d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" id="E49-MJMAIN-33" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#E49-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink"></use><use x="500" xlink:href="#E49-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1000,392)"><use transform="scale(0.707)" x="0" xlink:href="#E49-MJMAIN-2212" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="778" xlink:href="#E49-MJMAIN-33" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span><script id="MathJax-Element-48" type="math/tex">10^{-3}</script>左右。如果更低，说明学习率可能太小；如果更高，说明学习率可能太高

6. 一个不正确的初始化可能让学习过程变慢，甚至停止。这个问题可以比较简单的诊断出来：

    * 输出网络中所有层的激活数据和梯度分布的柱状图
    * 如果看到任何奇怪的分布，都不是好兆头。如；对于使用 tanh 的神经元，我们应该看到激活数据的值在整个 [-1,1] 区间都有分布。如果看到神经元的输出都是0，或者都在饱和部分，那么就有问题

7. 如果数据是图像像素数据，那么把第一层特征可视化会有帮助：

![training_img](../imgs/dl_practical/training_img.PNG)

    * 左图的特征充满了噪音，这暗示网络可能出现问题：网络没有收敛 、学习率设置不当、正则化惩罚的权重过低
    * 右图特征不错，平滑、干净、种类繁多。说明训练过程良好


## 六、示例：数字识别系统

1. 项目开始于性能度量的选择以及这些度量的期望。

    * 总的原则是：度量的选择要符合项目的业务目标
    * 因为地图只有高准确率时才有价值，所以该系统要求达到 98% 的准确率（达到人类水平）
    * 为了达到这个级别的准确率，系统牺牲了覆盖率。因此在保持准确率 98% 的前提下，覆盖率成了项目的主要性能度量

2. 选择基准系统：对于视觉任务而言，基准系统是带有 `ReLU`单元的卷积网络


## 七、数据预处理

1. 常见数据预处理方式：（红色的线指出各维度的数值范围）

![data_process1](../imgs/dl_practical/data_process1.PNG)

    * 均值减法：对数据中每个独立特征减去均值，集合上理解为：在每个维度上，都将数据云的中心迁移到原点

    * 归一化：将所有维度都做归一化：

        * 第一种做法：先对数据做零中心化处理，然后每个维度都除以标准差
        * 第二种做法：每个维度都做归一化，使得每个维度最大和最小值都是 1 和 -1

    * PCA 降维：取得数据的主成分，可以对数据去除相关性

    * 白化`whitening`：先对数据进行旋转（旋转的矩阵就是 SVD 分解中的 U矩阵），然后对每个维度除以特征值（为防止分母为0，通常加一个很小的值作为平滑系数）来对数值范围进行归一化

        * 如果数据服从多变量的高斯分布，则白化之后，数据的分布是一个均值为零，且协方差相等的矩阵
        * 该变换的缺点是：可能会放大数据中的噪声。因为它将所有维度都拉伸到相同的维度，这包括了那些大多数是噪声的维度。这个问题可以采用更强的平滑系数来解决

    ![data_process2](../imgs/dl_practical/data_process2.PNG)

    * 实际在神经网络中，并不会采用 PCA 和白化。


2. 任何预处理策略都只能在训练集的数据上进行，然后再应用到验证集或测试集上。

    * 如数据均值：首先分成训练集、验证集、测试集，从训练集中求数据的均值。然后训练集、验证集、测试集中的数据减去这个均值。 而不是减去测试集均值或者验证集均值

3. 激活函数：当前推荐使用 ReLU 激活函数

4. Batch Normalization：让数据在通过激活函数之前，添加一个 batch normalization


## 八、变量初始化

### 8.1 权重初始化

1. 权重一定不能全零初始化。因为这会导致神经元在前向传播中计算出同样的输出，然后在反向传播中计算出同样的梯度，从而进行同样的权重更新。这就产生了大量对称性神经元。

2. 通常采用小随机数初始化，通过这样来打破对称性。至于使用高斯分布还是均匀分布，对结果影响很小。

    * 之所以用小的随机数，是因为：如果网络中存在`tanh` 或者 `sigmoid` 激活函数，或者网络的输出层为`sigmoid` 等单元，则它们的变量值必须很小。

    如果使用较大的随机数，则很有可能这些单元会饱和，使得梯度趋近于零。这意味着基于梯度下降的算法推进的很慢，从而学习很慢。

    * 如果网络中不存在`sigmoid/tanh` 等激活函数，网络的输出层也不是`sigmoid` 等单元，则可以使用较大的随机数初始化。


3. 通常使用<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="3.978ex" role="img" style="vertical-align: -1.756ex;" viewbox="0 -956.9 1373.3 1712.8" width="3.19ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E50-MJMAIN-31" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E50-MJMATHI-6E" stroke-width="0"></path><path d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z" id="E50-MJMAIN-221A" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="1133" x="0" y="220"></rect><use transform="scale(0.707)" x="551" xlink:href="#E50-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink" y="571"></use><g transform="translate(60,-458)"><use transform="scale(0.707)" x="0" xlink:href="#E50-MJMAIN-221A" xmlns:xlink="http://www.w3.org/1999/xlink" y="-78"></use><rect height="42" stroke="none" width="424" x="589" y="468"></rect><use transform="scale(0.707)" x="833" xlink:href="#E50-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></svg></span><script id="MathJax-Element-49" type="math/tex">\frac 1{\sqrt n}</script>来校准权重初始化标准差。随着输入数据的增长，随机初始化的神经元的输出数据的分布中的方差也在增大。

假设权重<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.11ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -806.1 831 908.7" width="1.93ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M624 444Q636 441 722 441Q797 441 800 444H805V382H741L593 11Q592 10 590 8T586 4T584 2T581 0T579 -2T575 -3T571 -3T567 -4T561 -4T553 -4H542Q525 -4 518 6T490 70Q474 110 463 137L415 257L367 137Q357 111 341 72Q320 17 313 7T289 -4H277Q259 -4 253 -2T238 11L90 382H25V444H32Q47 441 140 441Q243 441 261 444H270V382H222L310 164L382 342L366 382H303V444H310Q322 441 407 441Q508 441 523 444H531V382H506Q481 382 481 380Q482 376 529 259T577 142L674 382H617V444H624Z" id="E51-MJMAINB-77" stroke-width="0"></path><path d="M-169 694Q-169 707 -160 715T-142 723Q-127 723 -119 716T-107 698T-90 673T-53 648Q-33 637 -33 619Q-33 602 -45 595T-87 573T-144 532Q-165 513 -176 513Q-189 513 -197 522T-206 543Q-206 556 -188 574L-175 588H-347L-519 589Q-542 597 -542 618Q-542 623 -541 627T-537 635T-532 640T-527 644T-522 648L-519 649H-149Q-169 676 -169 694Z" id="E51-MJMAINB-20D7" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E51-MJMAINB-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="686" xlink:href="#E51-MJMAINB-20D7" xmlns:xlink="http://www.w3.org/1999/xlink" y="6"></use></g></svg></span><script id="MathJax-Element-50" type="math/tex">\mathbf{\vec w}</script>和输入<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.994ex" role="img" style="vertical-align: -0.121ex;" viewbox="0 -806.1 607 858.4" width="1.41ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M227 0Q212 3 121 3Q40 3 28 0H21V62H117L245 213L109 382H26V444H34Q49 441 143 441Q247 441 265 444H274V382H246L281 339Q315 297 316 297Q320 297 354 341L389 382H352V444H360Q375 441 466 441Q547 441 559 444H566V382H471L355 246L504 63L545 62H586V0H578Q563 3 469 3Q365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63L217 62H235V0H227Z" id="E52-MJMAINB-78" stroke-width="0"></path><path d="M-169 694Q-169 707 -160 715T-142 723Q-127 723 -119 716T-107 698T-90 673T-53 648Q-33 637 -33 619Q-33 602 -45 595T-87 573T-144 532Q-165 513 -176 513Q-189 513 -197 522T-206 543Q-206 556 -188 574L-175 588H-347L-519 589Q-542 597 -542 618Q-542 623 -541 627T-537 635T-532 640T-527 644T-522 648L-519 649H-149Q-169 676 -169 694Z" id="E52-MJMAINB-20D7" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E52-MJMAINB-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="574" xlink:href="#E52-MJMAINB-20D7" xmlns:xlink="http://www.w3.org/1999/xlink" y="6"></use></g></svg></span><script id="MathJax-Element-51" type="math/tex">\mathbf{\vec x}</script>之间的内积为<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.811ex" role="img" style="vertical-align: -0.822ex;" viewbox="0 -856.4 5525.4 1210.2" width="12.833ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E53-MJMATHI-73" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E53-MJMAIN-3D" stroke-width="0"></path><path d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z" id="E53-MJSZ1-2211" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E53-MJMATHI-6E" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E53-MJMATHI-69" stroke-width="0"></path><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E53-MJMATHI-77" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E53-MJMATHI-78" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E53-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="746" xlink:href="#E53-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1802,0)"><use x="0" xlink:href="#E53-MJSZ1-2211" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1493" xlink:href="#E53-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="674"></use><use transform="scale(0.707)" x="1493" xlink:href="#E53-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-404"></use></g><g transform="translate(3549,0)"><use x="0" xlink:href="#E53-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E53-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><g transform="translate(4609,0)"><use x="0" xlink:href="#E53-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E53-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g></g></svg></span><script id="MathJax-Element-52" type="math/tex">s=\sum_i^n w_ix_i</script>（不考虑非线性激活函数）。我们检查<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 469 607.1" width="1.089ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E60-MJMATHI-73" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E60-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-59" type="math/tex">s</script>的方差
<span class="MathJax_Preview"></span><span class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="21.605ex" role="img" style="vertical-align: -17.748ex;" viewbox="0 -1660.6 38699.6 9302" width="89.883ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" id="E9-MJMATHI-56" stroke-width="0"></path><path d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" id="E9-MJMATHI-61" stroke-width="0"></path><path d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E9-MJMATHI-72" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E9-MJMAIN-28" stroke-width="0"></path><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E9-MJMATHI-73" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E9-MJMAIN-29" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E9-MJMAIN-3D" stroke-width="0"></path><path d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z" id="E9-MJSZ2-2211" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E9-MJMATHI-69" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E9-MJMATHI-6E" stroke-width="0"></path><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E9-MJMATHI-77" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E9-MJMATHI-78" stroke-width="0"></path><path d="M118 -250V750H255V710H158V-210H255V-250H118Z" id="E9-MJMAIN-5B" stroke-width="0"></path><path d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" id="E9-MJMATHI-45" stroke-width="0"></path><path d="M22 710V750H159V-250H22V-210H119V710H22Z" id="E9-MJMAIN-5D" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E9-MJMAIN-32" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E9-MJMAIN-2B" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(10404,0)"><use x="0" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="769" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1298" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1749" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2138" xlink:href="#E9-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2607" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3273" xlink:href="#E9-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4329" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5098" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="5627" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6078" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(6467,0)"><use x="0" xlink:href="#E9-MJSZ2-2211" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="848" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-1534"></use><use transform="scale(0.707)" x="721" xlink:href="#E9-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="1626"></use></g><g transform="translate(8078,0)"><use x="0" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><g transform="translate(9138,0)"><use x="0" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="10054" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="10720" xlink:href="#E9-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(11776,0)"><use x="0" xlink:href="#E9-MJSZ2-2211" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="848" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-1534"></use><use transform="scale(0.707)" x="721" xlink:href="#E9-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="1626"></use></g><use x="13387" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="14156" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="14685" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="15136" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(15525,0)"><use x="0" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><g transform="translate(16585,0)"><use x="0" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="17501" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(6308,-3186)"><use x="0" xlink:href="#E9-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1055,0)"><use x="0" xlink:href="#E9-MJSZ2-2211" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="848" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-1534"></use><use transform="scale(0.707)" x="721" xlink:href="#E9-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="1626"></use></g><use x="2499" xlink:href="#E9-MJMAIN-5B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2777" xlink:href="#E9-MJMATHI-45" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3541" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(3930,0)"><use x="0" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="4990" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(5379,0)"><use x="0" xlink:href="#E9-MJMAIN-5D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="393" xlink:href="#E9-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="583"></use></g><use x="6111" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6880" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7409" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7860" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(8249,0)"><use x="0" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="9165" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="9776" xlink:href="#E9-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="10776" xlink:href="#E9-MJMATHI-45" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="11540" xlink:href="#E9-MJMAIN-5B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="11818" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(12207,0)"><use x="0" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="13123" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(13512,0)"><use x="0" xlink:href="#E9-MJMAIN-5D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="393" xlink:href="#E9-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="583"></use></g><use x="14244" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="15013" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="15542" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="15993" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(16382,0)"><use x="0" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="17442" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="18053" xlink:href="#E9-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="19053" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="19822" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="20351" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="20802" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(21191,0)"><use x="0" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="22107" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="22496" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="23265" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="23794" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="24245" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(24634,0)"><use x="0" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="25694" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><g transform="translate(9974,-6372)"><use x="0" xlink:href="#E9-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1055,0)"><use x="0" xlink:href="#E9-MJSZ2-2211" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="848" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-1534"></use><use transform="scale(0.707)" x="721" xlink:href="#E9-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="1626"></use></g><use x="2666" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3435" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3964" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4415" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(4804,0)"><use x="0" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="5720" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6109" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6878" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7407" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7858" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(8247,0)"><use x="0" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E9-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="9307" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="9974" xlink:href="#E9-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="11029" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="11418" xlink:href="#E9-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="12018" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="12787" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="13316" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="13767" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="14156" xlink:href="#E9-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="14872" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="15261" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="15650" xlink:href="#E9-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="16419" xlink:href="#E9-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="16948" xlink:href="#E9-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="17399" xlink:href="#E9-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="17788" xlink:href="#E9-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="18360" xlink:href="#E9-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></svg></span></span><script id="MathJax-Element-8" type="math/tex; mode=display">Var(s)=Var(\sum_i^nw_ix_i)=\sum_i^nVar(w_ix_i)\\ =\sum_i^n[E(w_i)]^2Var(x_i)+E[(x_i)]^2Var(w_i)+Var(x_i)Var(w_i)\\ =\sum_i^nVar(x_i)Var(w_i)=(nVar(w))Var(x)</script>
其中假设输入和权重的平均值都是0，因此有<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 7783 1109.7" width="18.077ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" id="E55-MJMATHI-45" stroke-width="0"></path><path d="M118 -250V750H255V710H158V-210H255V-250H118Z" id="E55-MJMAIN-5B" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E55-MJMATHI-78" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E55-MJMATHI-69" stroke-width="0"></path><path d="M22 710V750H159V-250H22V-210H119V710H22Z" id="E55-MJMAIN-5D" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E55-MJMAIN-3D" stroke-width="0"></path><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E55-MJMATHI-77" stroke-width="0"></path><path d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" id="E55-MJMAIN-30" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E55-MJMATHI-45" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="764" xlink:href="#E55-MJMAIN-5B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1042,0)"><use x="0" xlink:href="#E55-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E55-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="1957" xlink:href="#E55-MJMAIN-5D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2513" xlink:href="#E55-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3569" xlink:href="#E55-MJMATHI-45" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="4333" xlink:href="#E55-MJMAIN-5B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(4611,0)"><use x="0" xlink:href="#E55-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E55-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g><use x="5671" xlink:href="#E55-MJMAIN-5D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="6227" xlink:href="#E55-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="7283" xlink:href="#E55-MJMAIN-30" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-54" type="math/tex">E[x_i]=E[w_i]=0</script>。同时假设所有的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.76ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -504.6 1060 757.9" width="2.462ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E56-MJMATHI-77" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E56-MJMATHI-69" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E56-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1012" xlink:href="#E56-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g></svg></span><script id="MathJax-Element-55" type="math/tex">w_i</script>服从同样的分布<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 2590.3 1109.7" width="6.016ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E57-MJMATHI-66" stroke-width="0"></path><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E57-MJMATHI-77" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E57-MJMAIN-28" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E57-MJMAIN-29" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E57-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="692" xlink:href="#E57-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use><use x="1096" xlink:href="#E57-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1485" xlink:href="#E57-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2201" xlink:href="#E57-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-56" type="math/tex">f_w(w)</script>，假设所有的<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.76ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -504.6 916 757.9" width="2.127ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E58-MJMATHI-78" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E58-MJMATHI-69" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E58-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="808" xlink:href="#E58-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use></g></svg></span><script id="MathJax-Element-57" type="math/tex">x_i</script>服从同样的分布<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.577ex" role="img" style="vertical-align: -0.705ex;" viewbox="0 -806.1 2344.5 1109.7" width="5.445ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" id="E59-MJMATHI-66" stroke-width="0"></path><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E59-MJMATHI-78" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E59-MJMAIN-28" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E59-MJMAIN-29" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E59-MJMATHI-66" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="692" xlink:href="#E59-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="-213"></use><use x="994" xlink:href="#E59-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1383" xlink:href="#E59-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1955" xlink:href="#E59-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-58" type="math/tex">f_x(x)</script>

    * 要使得输出<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 469 607.1" width="1.089ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z" id="E60-MJMATHI-73" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E60-MJMATHI-73" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-59" type="math/tex">s</script>和输入<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-60-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 572 607.1" width="1.329ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" id="E61-MJMATHI-78" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E61-MJMATHI-78" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-60" type="math/tex">x</script>具有同样的方差，则必须保证每个权重<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-61-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.41ex" role="img" style="vertical-align: -0.238ex;" viewbox="0 -504.6 716 607.1" width="1.663ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E62-MJMATHI-77" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E62-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-61" type="math/tex">w</script>的方差是<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="3.278ex" role="img" style="vertical-align: -1.055ex;" viewbox="0 -956.9 784.3 1411.3" width="1.822ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" id="E63-MJMAIN-31" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E63-MJMATHI-6E" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(120,0)"><rect height="60" stroke="none" width="544" x="0" y="220"></rect><use transform="scale(0.707)" x="134" xlink:href="#E63-MJMAIN-31" xmlns:xlink="http://www.w3.org/1999/xlink" y="571"></use><use transform="scale(0.707)" x="84" xlink:href="#E63-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="-488"></use></g></g></svg></span><script id="MathJax-Element-62" type="math/tex">\frac 1n</script>。则如果权重通过一个标准高斯分布初始化，则需要将标准差除以<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="2.811ex" role="img" style="vertical-align: -0.822ex;" viewbox="0 -856.4 1433 1210.2" width="3.328ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E64-MJMATHI-6E" stroke-width="0"></path><path d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z" id="E64-MJMAIN-221A" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E64-MJMAIN-221A" xmlns:xlink="http://www.w3.org/1999/xlink" y="-62"></use><rect height="60" stroke="none" width="600" x="833" y="678"></rect><use x="833" xlink:href="#E64-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></svg></span><script id="MathJax-Element-63" type="math/tex">\sqrt n</script>
    * 在`Glorot`的论文中，他推荐初始化公式为：<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="3.511ex" role="img" style="vertical-align: -1.289ex;" viewbox="0 -956.9 7658.1 1511.8" width="17.787ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" id="E65-MJMATHI-56" stroke-width="0"></path><path d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" id="E65-MJMATHI-61" stroke-width="0"></path><path d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E65-MJMATHI-72" stroke-width="0"></path><path d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" id="E65-MJMAIN-28" stroke-width="0"></path><path d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" id="E65-MJMATHI-77" stroke-width="0"></path><path d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" id="E65-MJMAIN-29" stroke-width="0"></path><path d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" id="E65-MJMAIN-3D" stroke-width="0"></path><path d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" id="E65-MJMAIN-32" stroke-width="0"></path><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E65-MJMATHI-6E" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E65-MJMATHI-69" stroke-width="0"></path><path d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" id="E65-MJMAIN-2B" stroke-width="0"></path><path d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z" id="E65-MJMATHI-6F" stroke-width="0"></path><path d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E65-MJMATHI-75" stroke-width="0"></path><path d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" id="E65-MJMATHI-74" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E65-MJMATHI-56" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="769" xlink:href="#E65-MJMATHI-61" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1298" xlink:href="#E65-MJMATHI-72" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="1749" xlink:href="#E65-MJMAIN-28" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2138" xlink:href="#E65-MJMATHI-77" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="2854" xlink:href="#E65-MJMAIN-29" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use x="3520" xlink:href="#E65-MJMAIN-3D" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(4298,0)"><g transform="translate(397,0)"><rect height="60" stroke="none" width="2841" x="0" y="220"></rect><use transform="scale(0.707)" x="1759" xlink:href="#E65-MJMAIN-32" xmlns:xlink="http://www.w3.org/1999/xlink" y="571"></use><g transform="translate(60,-345)"><use transform="scale(0.707)" x="0" xlink:href="#E65-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(424,-107)"><use transform="scale(0.5)" x="0" xlink:href="#E65-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.5)" x="345" xlink:href="#E65-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use transform="scale(0.707)" x="1368" xlink:href="#E65-MJMAIN-2B" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1517,0)"><use transform="scale(0.707)" x="0" xlink:href="#E65-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(424,-107)"><use transform="scale(0.5)" x="0" xlink:href="#E65-MJMATHI-6F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.5)" x="485" xlink:href="#E65-MJMATHI-75" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.5)" x="1057" xlink:href="#E65-MJMATHI-74" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></g></g></g></svg></span><script id="MathJax-Element-64" type="math/tex">Var(w)=\frac {2}{n_{in}+n_{out}}</script>。其中<span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-65-Frame" style="font-size: 100%; display: inline-block;" tabindex="-1"><svg focusable="false" height="1.76ex" role="img" style="vertical-align: -0.588ex;" viewbox="0 -504.6 3515.6 757.9" width="8.165ex" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" id="E66-MJMATHI-6E" stroke-width="0"></path><path d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" id="E66-MJMATHI-69" stroke-width="0"></path><path d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" id="E66-MJMAIN-2C" stroke-width="0"></path><path d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z" id="E66-MJMATHI-6F" stroke-width="0"></path><path d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" id="E66-MJMATHI-75" stroke-width="0"></path><path d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" id="E66-MJMATHI-74" stroke-width="0"></path></defs><g fill="currentColor" stroke="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use x="0" xlink:href="#E66-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" x="0" xlink:href="#E66-MJMATHI-69" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="345" xlink:href="#E66-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g><use x="1368" xlink:href="#E66-MJMAIN-2C" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(1812,0)"><use x="0" xlink:href="#E66-MJMATHI-6E" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" x="0" xlink:href="#E66-MJMATHI-6F" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="485" xlink:href="#E66-MJMATHI-75" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use><use transform="scale(0.707)" x="1057" xlink:href="#E66-MJMATHI-74" xmlns:xlink="http://www.w3.org/1999/xlink" y="0"></use></g></g></g></svg></span><script id="MathJax-Element-65" type="math/tex">n_{in},n_{out}</script>为输入和输出的数量。


### 8.2 偏置初始化

1. 通常将偏置初始化为0。这是因为随机小数值权重已经打破了对称性

## 九、结构设计

1. 对于任何给定的问题，很难提前去预测到底需要多深的神经网络。

一个常规的做法是：首先尝试使用逻辑回归（可以视为没有隐层的神经网络）。然后尝试单隐层的神经网络、双隐层的神经网络....

这种做法将隐层的数量看做是一个超参数。通过交叉验证来确定该超参数的值。



</body>